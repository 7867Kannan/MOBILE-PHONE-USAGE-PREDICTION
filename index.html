<!DOCTYPE html>
<html>
<head>
    <title>Mobile Addiction Predictor</title>

    <style>
        body{
            font-family: "Segoe UI", sans-serif;
            background: linear-gradient(120deg,#667eea,#764ba2);
            min-height:100vh;
            display:flex;
            justify-content:center;
            align-items:center;
            margin:0;
        }

        .card{
            background:white;
            width:420px;
            padding:30px;
            border-radius:20px;
            box-shadow:0 10px 25px rgba(0,0,0,0.2);
            text-align:center;
        }

        h2{
            margin-bottom:15px;
            color:#444;
        }

        input{
            width:100%;
            padding:10px;
            margin:7px 0;
            border-radius:10px;
            border:1px solid #ccc;
            outline:none;
            font-size:15px;
        }

        input:focus{
            border-color:#667eea;
            box-shadow:0 0 5px rgba(102,126,234,0.6);
        }

        button{
            margin-top:10px;
            width:100%;
            padding:12px;
            background:#667eea;
            color:white;
            border:none;
            border-radius:10px;
            font-size:16px;
            cursor:pointer;
            transition:0.3s;
        }

        button:hover{
            background:#4a63d9;
            transform:scale(1.02);
            box-shadow:0 5px 12px rgba(0,0,0,0.2);
        }

        .output{
            margin-top:15px;
            padding:10px;
            background:#f1f1f1;
            border-radius:10px;
            min-height:50px;
        }

        #result{
            color:#222;
            font-weight:bold;
            font-size:18px;
        }

        #most-used{
            color:#555;
            margin-top:5px;
        }

        #total-usage{
            color:#333;
            margin-top:5px;
        }

        .error{
            color:red;
            font-weight:bold;
            margin-top:10px;
        }

        #chart-container{
            margin-top:20px;
        }
    </style>

    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>

<div class="card">

    <h2>ðŸ“± Mobile Addiction Predictor</h2>

    <input type="number" id="social" placeholder="Social Media (hrs)" min="0" max="24">
    <input type="number" id="study" placeholder="Study (hrs)" min="0" max="24">
    <input type="number" id="entertainment" placeholder="Entertainment (hrs)" min="0" max="24">
    <input type="number" id="gaming" placeholder="Gaming (hrs)" min="0" max="24">

    <button onclick="predict()">Predict Addiction Level</button>

    <div class="output">
        <div id="result"></div>
        <div id="most-used"></div>
        <div id="total-usage"></div>
        <div class="error" id="error"></div>
    </div>

    <div id="chart-container">
        <canvas id="usageChart"></canvas>
    </div>

</div>

<script>
let chart; // global variable to store chart instance

async function predict() {
    const social = Number(document.getElementById("social").value) || 0;
    const study = Number(document.getElementById("study").value) || 0;
    const entertainment = Number(document.getElementById("entertainment").value) || 0;
    const gaming = Number(document.getElementById("gaming").value) || 0;

    const total = social + study + entertainment + gaming;

    // Clear previous messages
    document.getElementById("result").innerText = "";
    document.getElementById("most-used").innerText = "";
    document.getElementById("total-usage").innerText = "";
    document.getElementById("error").innerText = "";

    // Validation: each category â‰¤ 24
    if(social > 24 || study > 24 || entertainment > 24 || gaming > 24){
        document.getElementById("error").innerText = "Error: Each category cannot exceed 24 hours!";
        if(chart) chart.destroy();
        return;
    }

    // Validation: total â‰¤ 24
    if(total > 24){
        document.getElementById("error").innerText = "Error: Total hours cannot exceed 24!";
        if(chart) chart.destroy();
        return;
    }

    // Send data to backend
    const data = { social, study, entertainment, gaming };

    const res = await fetch("/predict", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
    });

    const out = await res.json();

    // Display prediction
    document.getElementById("result").innerText =
        "Prediction: " + out.prediction;
    document.getElementById("most-used").innerText =
        "Most used category: " + out.most_used;
    document.getElementById("total-usage").innerText =
        "Total hours: " + out.total;

    // Draw / update pie chart
    const ctx = document.getElementById('usageChart').getContext('2d');

    if(chart) chart.destroy(); // destroy previous chart

    chart = new Chart(ctx, {
        type: 'pie',
        data: {
            labels: ['Social Media', 'Study', 'Entertainment', 'Gaming'],
            datasets: [{
                data: [social, study, entertainment, gaming],
                backgroundColor: [
                    '#667eea',
                    '#764ba2',
                    '#f6c90e',
                    '#ff6b6b'
                ]
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: { position: 'bottom' }
            }
        }
    });
}
</script>

</body>
</html>
